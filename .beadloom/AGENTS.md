# Beadloom — Agent Instructions

> Auto-generated by `beadloom init`. Safe to edit.
> Sections below `## Custom` are preserved on regeneration.

## Before starting work

- Call MCP tool `prime` to get current project context
- Or run `beadloom prime` in terminal
- For specific feature/domain: `beadloom ctx <ref-id>` or MCP `get_context(ref_id)`
- Search the codebase: `beadloom search "<query>"`
- If no ref_id is given: `list_nodes()` to discover the graph

## After changing code

1. `beadloom reindex` — update the index
2. `beadloom sync-check` — check for stale docs
3. If stale: update docs, then `beadloom reindex` again
4. `beadloom lint --strict` — verify architecture boundaries

## Conventions

- Feature IDs: DOMAIN-NNN (e.g., AUTH-001)
- Annotations: `# beadloom:feature=REF_ID` in code files
- Documentation: `docs/` directory
- Graph YAML: `.beadloom/_graph/`

## Available MCP Tools

| Tool | Description |
|------|-------------|
| `prime` | Compact project context for session start |
| `get_context` | Full context bundle (graph + docs + code) |
| `get_graph` | Subgraph around a node |
| `list_nodes` | List nodes, optionally by kind |
| `sync_check` | Check doc-code freshness |
| `get_status` | Index statistics and coverage |
| `search` | Full-text search across nodes and docs |
| `update_node` | Update node summary or source |
| `mark_synced` | Mark doc-code pair as synchronized |
| `generate_docs` | Enrichment data for AI doc polish |
| `why` | Impact analysis — upstream and downstream deps |
| `diff` | Graph changes since a git ref |
| `lint` | Architecture boundary violations with severity |

## Architecture Rules

- **domain-needs-parent** (require): Every domain must be part_of the beadloom service
- **feature-needs-domain** (require): Every feature must be part_of a domain
- **service-needs-parent** (require): Every service (except root) must be part_of the beadloom service
- **no-domain-depends-on-service** (deny): Domains must not have depends_on edges to services
- **no-dependency-cycles** (deny): No circular depends_on chains
- **architecture-layers** (deny): Services use domains, domains use infrastructure — not reverse
- **domain-size-limit** (deny): Domains should not have too many symbols
- **tui-no-direct-infra** (deny): TUI must not import infrastructure directly
- **onboarding-no-direct-infra** (deny): Onboarding must not import infrastructure directly

## Custom

<!-- Add project-specific instructions below this line -->
